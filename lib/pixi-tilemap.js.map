{"version":3,"file":"pixi-tilemap.js","sourceRoot":"","sources":["../src/CanvasTileRenderer.ts","../src/CompositeRectTileLayer.ts","../src/GraphicsLayer.ts","../src/RectTileLayer.ts","../src/RectTileShader.ts","../src/SquareTileShader.ts","../src/TileRenderer.ts","../src/ZLayer.ts","../src/shaderGenerator.ts"],"names":[],"mappings":"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","sourcesContent":["module PIXI.tilemap {\n    export class CanvasTileRenderer {\n        renderer: PIXI.CanvasRenderer;\n        tileAnim = [0, 0];\n        dontUseTransform = false;\n\n        constructor(renderer: PIXI.CanvasRenderer) {\n            this.renderer = renderer;\n            this.tileAnim = [0, 0];\n        }\n    }\n\n    PIXI.CanvasRenderer.registerPlugin('tilemap', CanvasTileRenderer);\n}\n\n","/// <reference types=\"pixi.js\" />\n\nmodule PIXI.tilemap {\n    export class CompositeRectTileLayer extends PIXI.Container {\n        constructor(zIndex?: number, bitmaps?: Array<Texture>, texPerChild?: number) {\n            super();\n            this.initialize.apply(this, arguments);\n        }\n\n        updateTransform() {\n            super.displayObjectUpdateTransform()\n        }\n\n        z: number;\n        zIndex: number;\n        shadowColor = new Float32Array([0.0, 0.0, 0.0, 0.5]);\n        texPerChild: number;\n        modificationMarker = 0;\n        _globalMat: PIXI.Matrix = null;\n        _tempScale: Array<number> = null;\n\n        initialize(zIndex?: number, bitmaps?: Array<Texture>, texPerChild?: number) {\n            this.z = this.zIndex = zIndex;\n            this.texPerChild = texPerChild || 16;\n            if (bitmaps) {\n                this.setBitmaps(bitmaps);\n            }\n        }\n\n        setBitmaps(bitmaps: Array<Texture>) {\n            var texPerChild = this.texPerChild;\n            var len1 = this.children.length;\n            var len2 = Math.ceil(bitmaps.length / texPerChild);\n            var i: number;\n            for (i = 0; i < len1; i++) {\n                (this.children[i] as RectTileLayer).textures = bitmaps.slice(i * texPerChild, (i + 1) * texPerChild);\n            }\n            for (i = len1; i < len2; i++) {\n                this.addChild(new RectTileLayer(this.zIndex, bitmaps.slice(i * texPerChild, (i + 1) * texPerChild)));\n            }\n        }\n\n        clear() {\n            for (var i = 0; i < this.children.length; i++)\n                (this.children[i] as RectTileLayer).clear();\n            this.modificationMarker = 0;\n        }\n\n        addRect(num: number, u: number, v: number, x: number, y: number, tileWidth: number, tileHeight: number) {\n            if (this.children[num] && (this.children[num] as RectTileLayer).textures)\n                (this.children[num] as RectTileLayer).addRect(0, u, v, x, y, tileWidth, tileHeight);\n        }\n\n        addFrame(texture_: PIXI.Texture | String | number, x: number, y: number, animX: number, animY: number) {\n            var texture : PIXI.Texture;\n            var layer : RectTileLayer = null, ind = 0;\n            var children = this.children;\n\n            if (typeof texture_ === \"number\") {\n                var childIndex = texture_ / this.texPerChild >> 0;\n                layer = children[childIndex] as RectTileLayer;\n\n                if (!layer) {\n                    layer = children[0] as RectTileLayer;\n                    if (!layer) {\n                        return false;\n                    }\n                    ind = 0;\n                } else {\n                    ind = texture_ % this.texPerChild;\n                }\n\n                texture = layer.textures[ind];\n            } else {\n                if (typeof texture_ === \"string\") {\n                    texture = PIXI.Texture.fromImage(texture_);\n                } else {\n                    texture = texture_ as PIXI.Texture;\n                }\n\n                for (var i = 0; i < children.length; i++) {\n                    var child = children[i] as RectTileLayer;\n                    var tex = child.textures;\n                    for (var j = 0; j < tex.length; j++) {\n                        if (tex[j].baseTexture === texture.baseTexture) {\n                            layer = child;\n                            ind = j;\n                            break;\n                        }\n                    }\n                    if (layer) {\n                        break;\n                    }\n                }\n\n                if (!layer) {\n                    for (i = 0; i < children.length; i++) {\n                        var child = children[i] as RectTileLayer;\n                        if (child.textures.length < this.texPerChild) {\n                            layer = child;\n                            ind = child.textures.length;\n                            child.textures.push(texture);\n                            break;\n                        }\n                    }\n                    if (!layer) {\n                        children.push(layer = new RectTileLayer(this.zIndex, texture));\n                        ind = 0;\n                    }\n                }\n            }\n\n            layer.addRect(ind, texture.frame.x, texture.frame.y, x, y, texture.frame.width, texture.frame.height, animX, animY);\n            return true;\n        };\n\n        renderCanvas(renderer: CanvasRenderer) {\n            if (!renderer.plugins.tilemap.dontUseTransform) {\n                var wt = this.worldTransform;\n                renderer.context.setTransform(\n                    wt.a,\n                    wt.b,\n                    wt.c,\n                    wt.d,\n                    wt.tx * renderer.resolution,\n                    wt.ty * renderer.resolution\n                );\n            }\n            var layers = this.children;\n            for (var i = 0; i < layers.length; i++)\n                layers[i].renderCanvas(renderer);\n        };\n\n        renderWebGL(renderer: WebGLRenderer) {\n            var gl = renderer.gl;\n            var shader = renderer.plugins.tilemap.getShader();\n            renderer.setObjectRenderer(renderer.plugins.tilemap);\n            renderer.bindShader(shader);\n            //TODO: dont create new array, please\n            this._globalMat = this._globalMat || new PIXI.Matrix();\n            renderer._activeRenderTarget.projectionMatrix.copy(this._globalMat).append(this.worldTransform);\n            shader.uniforms.projectionMatrix = this._globalMat.toArray(true);\n            shader.uniforms.shadowColor = this.shadowColor;\n            var af = shader.uniforms.animationFrame = renderer.plugins.tilemap.tileAnim;\n            //shader.syncUniform(shader.uniforms.animationFrame);\n            var layers = this.children;\n            for (var i = 0; i < layers.length; i++)\n                (layers[i] as RectTileLayer).renderWebGL(renderer);\n        }\n\n        isModified(anim: boolean) {\n            var layers = this.children;\n            if (this.modificationMarker != layers.length) {\n                return true;\n            }\n            for (var i = 0; i < layers.length; i++) {\n                const layer = layers[i] as RectTileLayer;\n                if (layer.modificationMarker != layer.pointsBuf.length ||\n                    anim && layer.hasAnim) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        clearModify() {\n            var layers = this.children;\n            this.modificationMarker = layers.length;\n            for (var i = 0; i < layers.length; i++) {\n                const layer = layers[i] as RectTileLayer;\n                layer.modificationMarker = layer.pointsBuf.length;\n            }\n        }\n\n    }\n}\n","module PIXI.tilemap {\n\n    class GraphicsLayer extends PIXI.Graphics {\n        z: number;\n        zIndex: number;\n\n        constructor(zIndex: number) {\n            super();\n            this.z = this.zIndex = zIndex;\n        }\n\n        renderCanvas(renderer: PIXI.CanvasRenderer) {\n            var wt : PIXI.Matrix = null;\n            if (renderer.plugins.tilemap.dontUseTransform) {\n                wt = this.transform.worldTransform;\n                this.transform.worldTransform = PIXI.Matrix.IDENTITY;\n            }\n            renderer.plugins.graphics.render(this);\n            if (renderer.plugins.tilemap.dontUseTransform) {\n                this.transform.worldTransform = wt;\n            }\n            renderer.context.globalAlpha = 1.0;\n        }\n\n        renderWebGL(renderer: WebGLRenderer) {\n            if (!this._webGL[renderer.CONTEXT_UID])\n                this.dirty = true;\n            super.renderWebGL(renderer)\n        }\n\n        isModified(anim: boolean): boolean {\n            return false;\n        }\n\n        clearModify() {\n        }\n    }\n\n}\n","module PIXI.tilemap {\n\n    export class RectTileLayer extends PIXI.Container {\n        constructor(zIndex: number, texture: PIXI.Texture | Array<PIXI.Texture>) {\n            super();\n            this.initialize(zIndex, texture);\n        }\n\n        textures: Array<Texture>;\n        z = 0;\n        zIndex = 0;\n        pointsBuf : Array<number> = [];\n        _tempSize = new Float32Array([0, 0]);\n        _tempTexSize = 1;\n        modificationMarker = 0;\n        hasAnim = false;\n\n        initialize(zIndex : number, textures: PIXI.Texture | Array<PIXI.Texture>) {\n            if (!textures) {\n                textures = [];\n            } else if (!(textures instanceof Array) && (textures as PIXI.Texture).baseTexture) {\n                textures = [textures as PIXI.Texture];\n            }\n            this.textures = textures as Array<PIXI.Texture>;\n            this.z = this.zIndex = zIndex;\n            this.visible = false;\n        }\n\n        clear() {\n            this.pointsBuf.length = 0;\n            this.modificationMarker = 0;\n            this.hasAnim = false;\n        }\n\n        renderCanvas(renderer: CanvasRenderer) {\n            if (this.textures.length === 0) return;\n            var points = this.pointsBuf;\n            renderer.context.fillStyle = '#000000';\n            for (var i = 0, n = points.length; i < n; i += 9) {\n                var x1 = points[i], y1 = points[i + 1];\n                var x2 = points[i + 2], y2 = points[i + 3];\n                var w = points[i + 4];\n                var h = points[i + 5];\n                x1 += points[i + 6] * renderer.plugins.tilemap.tileAnim[0];\n                y1 += points[i + 7] * renderer.plugins.tilemap.tileAnim[1];\n                var textureId = points[i + 8];\n                if (textureId >= 0) {\n                    renderer.context.drawImage(this.textures[textureId].baseTexture.source, x1, y1, w, h, x2, y2, w, h);\n                } else {\n                    renderer.context.globalAlpha = 0.5;\n                    renderer.context.fillRect(x2, y2, w, h);\n                    renderer.context.globalAlpha = 1;\n                }\n            }\n        }\n\n        addRect(textureId: number, u: number, v: number, x: number, y: number, tileWidth: number, tileHeight: number, animX: number = 0, animY: number = 0) {\n            var pb = this.pointsBuf;\n            this.hasAnim = this.hasAnim || animX > 0 || animY > 0;\n            if (tileWidth === tileHeight) {\n                pb.push(u);\n                pb.push(v);\n                pb.push(x);\n                pb.push(y);\n                pb.push(tileWidth);\n                pb.push(tileHeight);\n                pb.push(animX | 0);\n                pb.push(animY | 0);\n                pb.push(textureId);\n            } else {\n                var i: number;\n                if (tileWidth % tileHeight === 0) {\n                    //horizontal line on squares\n                    for (i = 0; i < tileWidth / tileHeight; i++) {\n                        pb.push(u + i * tileHeight);\n                        pb.push(v);\n                        pb.push(x + i * tileHeight);\n                        pb.push(y);\n                        pb.push(tileHeight);\n                        pb.push(tileHeight);\n                        pb.push(animX | 0);\n                        pb.push(animY | 0);\n                        pb.push(textureId);\n                    }\n                } else if (tileHeight % tileWidth === 0) {\n                    //vertical line on squares\n                    for (i = 0; i < tileHeight / tileWidth; i++) {\n                        pb.push(u);\n                        pb.push(v + i * tileWidth);\n                        pb.push(x);\n                        pb.push(y + i * tileWidth);\n                        pb.push(tileWidth);\n                        pb.push(tileWidth);\n                        pb.push(animX | 0);\n                        pb.push(animY | 0);\n                        pb.push(textureId);\n                    }\n                } else {\n                    //ok, ok, lets use rectangle\n                    pb.push(u);\n                    pb.push(v);\n                    pb.push(x);\n                    pb.push(y);\n                    pb.push(tileWidth);\n                    pb.push(tileHeight);\n                    pb.push(animX | 0);\n                    pb.push(animY | 0);\n                    pb.push(textureId);\n                }\n            }\n        };\n\n        vbId = 0;\n        vbBuffer : ArrayBuffer = null;\n        vbArray : Float32Array = null;\n        vbInts : Uint32Array = null;\n\n        renderWebGL(renderer: WebGLRenderer) {\n            var points = this.pointsBuf;\n            if (points.length === 0) return;\n            var rectsCount = points.length / 9;\n            var tile = renderer.plugins.tilemap;\n            var gl = renderer.gl;\n\n            tile.checkIndexBuffer(rectsCount);\n\n            var shader = tile.getShader();\n            var textures = this.textures;\n            if (textures.length === 0) return;\n            var len = textures.length;\n            if (this._tempTexSize < shader.maxTextures) {\n                this._tempTexSize = shader.maxTextures;\n                this._tempSize = new Float32Array(2 * shader.maxTextures);\n            }\n            // var samplerSize = this._tempSize;\n            for (var i = 0; i < len; i++) {\n                if (!textures[i] || !textures[i].valid) return;\n                var texture = textures[i].baseTexture;\n                // samplerSize[i * 2] = 1.0 / texture.width;\n                // samplerSize[i * 2 + 1] = 1.0 / texture.height;\n            }\n            tile.bindTextures(renderer, shader, textures);\n            // shader.uniforms.uSamplerSize = samplerSize;\n            //lost context! recover!\n            var vb = tile.getVb(this.vbId);\n            if (!vb) {\n                vb = tile.createVb();\n                this.vbId = vb.id;\n                this.vbBuffer = null;\n                this.modificationMarker = 0;\n            }\n            var vao = vb.vao;\n            renderer.bindVao(vao);\n            var vertexBuf = vb.vb as glCore.GLBuffer;\n            //if layer was changed, re-upload vertices\n            vertexBuf.bind();\n            var vertices = rectsCount * shader.vertPerQuad;\n            if (vertices === 0) return;\n            if (this.modificationMarker != vertices) {\n                this.modificationMarker = vertices;\n                var vs = shader.stride * vertices;\n                if (!this.vbBuffer || this.vbBuffer.byteLength < vs) {\n                    //!@#$ happens, need resize\n                    var bk = shader.stride;\n                    while (bk < vs) {\n                        bk *= 2;\n                    }\n                    this.vbBuffer = new ArrayBuffer(bk);\n                    this.vbArray = new Float32Array(this.vbBuffer);\n                    this.vbInts = new Uint32Array(this.vbBuffer);\n                    vertexBuf.upload(this.vbBuffer, 0, true);\n                }\n\n                var arr = this.vbArray, ints = this.vbInts;\n                //upload vertices!\n                var sz = 0;\n                //var tint = 0xffffffff;\n                var textureId: number, shiftU: number, shiftV: number;\n\n                //var tint = 0xffffffff;\n                var tint = -1;\n                for (i = 0; i < points.length; i += 9) {\n                    var eps = 0.5;\n                    textureId = (points[i + 8] >> 2);\n                    shiftU = 1024 * (points[i + 8] & 1);\n                    shiftV = 1024 * ((points[i + 8] >> 1) & 1);\n                    var x = points[i + 2], y = points[i + 3];\n                    var w = points[i + 4], h = points[i + 5];\n                    var u = points[i] + shiftU, v = points[i + 1] + shiftV;\n                    var animX = points[i + 6], animY = points[i + 7];\n                    arr[sz++] = x;\n                    arr[sz++] = y;\n                    arr[sz++] = u;\n                    arr[sz++] = v;\n                    arr[sz++] = u + eps;\n                    arr[sz++] = v + eps;\n                    arr[sz++] = u + w - eps;\n                    arr[sz++] = v + h - eps;\n                    arr[sz++] = animX;\n                    arr[sz++] = animY;\n                    arr[sz++] = textureId;\n                    arr[sz++] = x + w;\n                    arr[sz++] = y;\n                    arr[sz++] = u + w;\n                    arr[sz++] = v;\n                    arr[sz++] = u + eps;\n                    arr[sz++] = v + eps;\n                    arr[sz++] = u + w - eps;\n                    arr[sz++] = v + h - eps;\n                    arr[sz++] = animX;\n                    arr[sz++] = animY;\n                    arr[sz++] = textureId;\n                    arr[sz++] = x + w;\n                    arr[sz++] = y + h;\n                    arr[sz++] = u + w;\n                    arr[sz++] = v + h;\n                    arr[sz++] = u + eps;\n                    arr[sz++] = v + eps;\n                    arr[sz++] = u + w - eps;\n                    arr[sz++] = v + h - eps;\n                    arr[sz++] = animX;\n                    arr[sz++] = animY;\n                    arr[sz++] = textureId;\n                    arr[sz++] = x;\n                    arr[sz++] = y + h;\n                    arr[sz++] = u;\n                    arr[sz++] = v + h;\n                    arr[sz++] = u + eps;\n                    arr[sz++] = v + eps;\n                    arr[sz++] = u + w - eps;\n                    arr[sz++] = v + h - eps;\n                    arr[sz++] = animX;\n                    arr[sz++] = animY;\n                    arr[sz++] = textureId;\n                }\n\n                // if (vs > this.vbArray.length/2 ) {\n                vertexBuf.upload(arr, 0, true);\n                // } else {\n                //     var view = arr.subarray(0, vs);\n                //     vb.upload(view, 0);\n                // }\n            }\n            gl.drawElements(gl.TRIANGLES, rectsCount * 6, gl.UNSIGNED_SHORT, 0);\n        }\n    }\n\n}\n","module PIXI.tilemap {\n\n    import GLBuffer = PIXI.glCore.GLBuffer;\n    import VertexArrayObject = PIXI.glCore.VertexArrayObject;\n    var rectShaderFrag = `varying vec2 vTextureCoord;\nvarying vec4 vFrame;\nvarying float vTextureId;\nuniform vec4 shadowColor;\nuniform sampler2D uSamplers[%count%];\nuniform vec2 uSamplerSize[%count%];\n\nvoid main(void){\n   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);\n   float textureId = floor(vTextureId + 0.5);\n\n   vec4 color;\n   %forloop%\n   gl_FragColor = color;\n}`;\n\n    var rectShaderVert = `\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aFrame;\nattribute vec2 aAnim;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform vec2 animationFrame;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vFrame;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vec2 anim = aAnim * animationFrame;\n   vTextureCoord = aTextureCoord + anim;\n   vFrame = aFrame + vec4(anim, anim);\n   vTextureId = aTextureId;\n}\n`;\n\n    export abstract class TilemapShader extends PIXI.Shader {\n        maxTextures = 0;\n        indexBuffer: GLBuffer;\n        constructor(gl: WebGLRenderingContext, maxTextures: number, shaderVert: string, shaderFrag: string) {\n            super(gl,\n                shaderVert,\n                shaderFrag\n            );\n            this.maxTextures = maxTextures;\n            shaderGenerator.fillSamplers(this, this.maxTextures);\n        }\n\n        abstract createVao(renderer : WebGLRenderer, vb: GLBuffer) : VertexArrayObject;\n    }\n\n    export class RectTileShader extends TilemapShader {\n        vertSize = 11;\n        vertPerQuad = 4;\n        stride = this.vertSize * 4;\n\n        constructor(gl: WebGLRenderingContext, maxTextures: number) {\n            super(gl,\n                maxTextures,\n                rectShaderVert,\n                shaderGenerator.generateFragmentSrc(maxTextures, rectShaderFrag)\n            );\n            shaderGenerator.fillSamplers(this, this.maxTextures);\n        }\n\n        createVao(renderer : WebGLRenderer, vb: GLBuffer) {\n            var gl = renderer.gl;\n            return renderer.createVao()\n                .addIndex(this.indexBuffer)\n                .addAttribute(vb, this.attributes.aVertexPosition, gl.FLOAT, false, this.stride, 0)\n                .addAttribute(vb, this.attributes.aTextureCoord, gl.FLOAT, false, this.stride, 2 * 4)\n                .addAttribute(vb, this.attributes.aFrame, gl.FLOAT, false, this.stride, 4 * 4)\n                .addAttribute(vb, this.attributes.aAnim, gl.FLOAT, false, this.stride, 8 * 4)\n                .addAttribute(vb, this.attributes.aTextureId, gl.FLOAT, false, this.stride, 10 * 4);\n        }\n    }\n}\n","module PIXI.tilemap {\n\n    import GLBuffer = PIXI.glCore.GLBuffer;\n    import VertexArrayObject = PIXI.glCore.VertexArrayObject;\n\n    var squareShaderVert = `\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aAnim;\nattribute float aTextureId;\nattribute float aSize;\n\nuniform mat3 projectionMatrix;\nuniform vec2 samplerSize;\nuniform vec2 animationFrame;\nuniform float projectionScale;\n\nvarying vec2 vTextureCoord;\nvarying float vSize;\nvarying float vTextureId;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition + aSize * 0.5, 1.0)).xy, 0.0, 1.0);\n   gl_PointSize = aSize * projectionScale;\n   vTextureCoord = aTextureCoord + aAnim * animationFrame;\n   vTextureId = aTextureId;\n   vSize = aSize;\n}\n`;\n\n    var squareShaderFrag = `\nvarying vec2 vTextureCoord;\nvarying float vSize;\nvarying float vTextureId;\n\nuniform vec4 shadowColor;\nuniform sampler2D uSamplers[%count%];\nuniform vec2 uSamplerSize[%count%];\nuniform vec2 pointScale;\n\nvoid main(void){\n   float margin = 0.5 / vSize;\n   vec2 pointCoord = (gl_PointCoord - 0.5) * pointScale + 0.5;\n   vec2 clamped = vec2(clamp(pointCoord.x, margin, 1.0 - margin), clamp(pointCoord.y, margin, 1.0 - margin));\n   vec2 textureCoord = pointCoord * vSize + vTextureCoord;\n   float textureId = vTextureId;\n   vec4 color;\n   %forloop%\n   gl_FragColor = color;\n}\n\n`;\n\n    export class SquareTileShader extends TilemapShader {\n        vertSize = 8;\n        vertPerQuad = 1;\n        stride = this.vertSize * 4;\n\n        constructor(gl: WebGLRenderingContext, maxTextures: number) {\n            super(gl,\n                maxTextures,\n                squareShaderVert,\n                shaderGenerator.generateFragmentSrc(maxTextures, squareShaderFrag)\n            );\n            this.maxTextures = maxTextures;\n            shaderGenerator.fillSamplers(this, this.maxTextures);\n        }\n\n        indexBuffer: GLBuffer;\n\n        createVao(renderer: WebGLRenderer, vb: GLBuffer): VertexArrayObject {\n            var gl = renderer.gl;\n            return renderer.createVao()\n                .addIndex(this.indexBuffer)\n                .addAttribute(vb, this.attributes.aVertexPosition, gl.FLOAT, false, this.stride, 0)\n                .addAttribute(vb, this.attributes.aTextureCoord, gl.FLOAT, false, this.stride, 2 * 4)\n                .addAttribute(vb, this.attributes.aSize, gl.FLOAT, false, this.stride, 4 * 4)\n                .addAttribute(vb, this.attributes.aAnim, gl.FLOAT, false, this.stride, 5 * 4)\n                .addAttribute(vb, this.attributes.aTextureId, gl.FLOAT, false, this.stride, 7 * 4);\n        };\n    }\n}","module PIXI.tilemap {\n    import glCore = PIXI.glCore;\n    function _hackSubImage(tex: glCore.GLTexture, sprite: PIXI.Sprite, clearBuffer?: Uint8Array, clearWidth?: number, clearHeight?: number) {\n        const gl = tex.gl;\n        const baseTex = sprite.texture.baseTexture;\n        if (clearBuffer && clearWidth > 0 && clearHeight > 0)\n        {\n            gl.texSubImage2D(gl.TEXTURE_2D, 0, sprite.position.x, sprite.position.y, clearWidth, clearHeight, tex.format, tex.type, clearBuffer);\n        }\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);\n        gl.texSubImage2D(gl.TEXTURE_2D, 0, sprite.position.x, sprite.position.y, tex.format, tex.type, baseTex.source as HTMLImageElement);\n    }\n\n    /*\n     * Renderer for rectangle tiles.\n     *\n     * @class\n     * @memberof PIXI.tilemap\n     * @extends PIXI.ObjectRenderer\n     * @param renderer {PIXI.WebGLRenderer} The renderer this sprite batch works for.\n     */\n\n    export class TileRenderer extends PIXI.ObjectRenderer {\n\n        static vbAutoincrement = 0;\n        static SCALE_MODE = PIXI.SCALE_MODES.LINEAR;\n        static DO_CLEAR = false;\n        renderer: WebGLRenderer;\n        gl: WebGLRenderingContext;\n        vbs :  { [key: string]: any; } = {};\n        indices = new Uint16Array(0);\n        indexBuffer : glCore.GLBuffer;\n        _clearBuffer: Uint8Array;\n        lastTimeCheck = 0;\n        tileAnim = [0, 0];\n        maxTextures = 4;\n        texLoc : Array<number> = [];\n\n        rectShader: RectTileShader;\n        boundSprites: Array<PIXI.Sprite>;\n        glTextures: Array<PIXI.RenderTexture>;\n\n        constructor(renderer: WebGLRenderer) {\n            super(renderer)\n        }\n\n        onContextChange() {\n            const gl = this.renderer.gl;\n            const maxTextures = this.maxTextures;\n            this.rectShader = new RectTileShader(gl, maxTextures);\n            this.checkIndexBuffer(2000);\n            this.rectShader.indexBuffer = this.indexBuffer;\n            this.vbs = {};\n            this.glTextures = [];\n            this.boundSprites = [];\n            this.initBounds();\n        }\n\n        initBounds() {\n            const gl = this.renderer.gl;\n            for (let i = 0; i < this.maxTextures; i++) {\n                const rt = PIXI.RenderTexture.create(2048, 2048);\n                rt.baseTexture.premultipliedAlpha = true;\n                rt.baseTexture.scaleMode = TileRenderer.SCALE_MODE;\n                rt.baseTexture.wrapMode = PIXI.WRAP_MODES.CLAMP;\n                this.renderer.textureManager.updateTexture(rt);\n\n                this.glTextures.push(rt);\n                const bounds = this.boundSprites;\n                for (let j = 0; j < 4; j++) {\n                    const spr = new PIXI.Sprite();\n                    spr.position.x = 1024 * (j & 1);\n                    spr.position.y = 1024 * (j >> 1);\n                    bounds.push(spr);\n                }\n            }\n        }\n\n        bindTextures(renderer: WebGLRenderer, shader: TilemapShader, textures: Array<PIXI.Texture>) {\n            const len = textures.length;\n            const maxTextures = this.maxTextures;\n            if (len > 4 * maxTextures) {\n                return;\n            }\n            const doClear = TileRenderer.DO_CLEAR;\n            if (doClear && !this._clearBuffer) {\n                this._clearBuffer = new Uint8Array(1024 * 1024 * 4);\n            }\n            const glts = this.glTextures;\n            const bounds = this.boundSprites;\n\n            let i: number;\n            for (i = 0; i < len; i++) {\n                const texture = textures[i];\n                if (!texture || !textures[i].valid) continue;\n                const bs = bounds[i];\n                if (!bs.texture ||\n                    bs.texture.baseTexture !== texture.baseTexture) {\n                    bs.texture = texture;\n                    const glt = glts[i >> 2];\n                    renderer.bindTexture(glt, 0, true);\n                    if (doClear) {\n                        _hackSubImage((glt.baseTexture as any)._glTextures[renderer.CONTEXT_UID], bs, this._clearBuffer, 1024, 1024);\n                    } else {\n                        _hackSubImage((glt.baseTexture as any)._glTextures[renderer.CONTEXT_UID], bs);\n                    }\n                }\n            }\n            this.texLoc.length = 0;\n            for (i = 0; i < maxTextures; i++) {\n                //remove \"i, true\" after resolving a bug\n                this.texLoc.push(renderer.bindTexture(glts[i], i, true))\n            }\n            shader.uniforms.uSamplers = this.texLoc;\n        }\n\n        checkLeaks() {\n            const now = Date.now();\n            const old = now - 10000;\n            if (this.lastTimeCheck < old ||\n                this.lastTimeCheck > now) {\n                this.lastTimeCheck = now;\n                const vbs = this.vbs;\n                for (let key in vbs) {\n                    if (vbs[key].lastTimeAccess < old) {\n                        this.removeVb(key);\n                    }\n                }\n            }\n        };\n\n        start() {\n            this.renderer.state.setBlendMode(PIXI.BLEND_MODES.NORMAL);\n            //sorry, nothing\n        }\n\n        getVb(id: string) {\n            this.checkLeaks();\n            const vb = this.vbs[id];\n            if (vb) {\n                vb.lastAccessTime = Date.now();\n                return vb;\n            }\n            return null;\n        }\n\n        createVb() {\n            const id = ++TileRenderer.vbAutoincrement;\n            const shader = this.getShader();\n            const gl = this.renderer.gl;\n            const vb = PIXI.glCore.GLBuffer.createVertexBuffer(gl, null, gl.STREAM_DRAW);\n            const stuff = {\n                id: id,\n                vb: vb,\n                vao: shader.createVao(this.renderer, vb),\n                lastTimeAccess: Date.now(),\n                shader: shader\n            };\n            this.vbs[id] = stuff;\n            return stuff;\n        }\n\n        removeVb(id: string) {\n            if (this.vbs[id]) {\n                this.vbs[id].vb.destroy();\n                this.vbs[id].vao.destroy();\n                delete this.vbs[id];\n            }\n        }\n\n        checkIndexBuffer(size: number) {\n            // the total number of indices in our array, there are 6 points per quad.\n            const totalIndices = size * 6;\n            let indices = this.indices;\n            if (totalIndices <= indices.length) {\n                return;\n            }\n            let len = indices.length || totalIndices;\n            while (len < totalIndices) {\n                len <<= 1;\n            }\n\n            indices = new Uint16Array(len);\n            this.indices = indices;\n\n            // fill the indices with the quads to draw\n            for (let i = 0, j = 0; i + 5 < indices.length; i += 6, j += 4) {\n                indices[i + 0] = j + 0;\n                indices[i + 1] = j + 1;\n                indices[i + 2] = j + 2;\n                indices[i + 3] = j + 0;\n                indices[i + 4] = j + 2;\n                indices[i + 5] = j + 3;\n            }\n\n            if (this.indexBuffer) {\n                this.indexBuffer.upload(indices);\n            } else {\n                let gl = this.renderer.gl;\n                this.indexBuffer = glCore.GLBuffer.createIndexBuffer(gl, this.indices, gl.STATIC_DRAW);\n            }\n        }\n\n        getShader() : TilemapShader {\n            return this.rectShader;\n        }\n\n        destroy() {\n            super.destroy();\n            this.rectShader.destroy();\n            this.rectShader = null;\n        };\n    }\n\n    PIXI.WebGLRenderer.registerPlugin('tilemap', TileRenderer);\n\n}\n","module PIXI.tilemap {\n\n    export class ZLayer extends PIXI.Container {\n        constructor(tilemap: PIXI.Container, zIndex: number) {\n            super();\n            this.tilemap = tilemap;\n            this.z = zIndex;\n        }\n\n        tilemap: any;\n        z: number;\n        zIndex: number;\n        _previousLayers: number;\n        canvasBuffer: HTMLCanvasElement;\n        _tempRender: PIXI.CanvasRenderer;\n        _lastAnimationFrame: number = -1;\n        layerTransform: PIXI.Matrix;\n\n        clear() {\n            var layers = this.children as Array<CompositeRectTileLayer>;\n            for (var i = 0; i < layers.length; i++)\n                layers[i].clear();\n            this._previousLayers = 0;\n        }\n\n        cacheIfDirty() {\n            var tilemap: any = this.tilemap;\n            var layers = this.children as Array<CompositeRectTileLayer>;\n            var modified = this._previousLayers != layers.length;\n            this._previousLayers = layers.length;\n            var buf = this.canvasBuffer;\n            var tempRender = this._tempRender;\n            if (!buf) {\n                buf = this.canvasBuffer = document.createElement('canvas');\n                tempRender = this._tempRender = new PIXI.CanvasRenderer(100, 100, {view: buf});\n                tempRender.context = tempRender.rootContext;\n                tempRender.plugins.tilemap.dontUseTransform = true;\n            }\n            if (buf.width != tilemap._layerWidth ||\n                buf.height != tilemap._layerHeight) {\n                buf.width = tilemap._layerWidth;\n                buf.height = tilemap._layerHeight;\n                modified = true;\n            }\n            var i: number;\n            if (!modified) {\n                for (i = 0; i < layers.length; i++) {\n                    if (layers[i].isModified(this._lastAnimationFrame != tilemap.animationFrame)) {\n                        modified = true;\n                        break;\n                    }\n                }\n            }\n            this._lastAnimationFrame = tilemap.animationFrame;\n            if (modified) {\n                if (tilemap._hackRenderer) {\n                    tilemap._hackRenderer(tempRender);\n                }\n                tempRender.context.clearRect(0, 0, buf.width, buf.height);\n                for (i = 0; i < layers.length; i++) {\n                    layers[i].clearModify();\n                    layers[i].renderCanvas(tempRender);\n                }\n            }\n            this.layerTransform = this.worldTransform;\n            for (i = 0; i < layers.length; i++) {\n                this.layerTransform = layers[i].worldTransform;\n                break;\n            }\n        };\n\n        renderCanvas(renderer: PIXI.CanvasRenderer) {\n            this.cacheIfDirty();\n            var wt = this.layerTransform;\n            renderer.context.setTransform(\n                wt.a,\n                wt.b,\n                wt.c,\n                wt.d,\n                wt.tx * renderer.resolution,\n                wt.ty * renderer.resolution\n            );\n            var tilemap = this.tilemap;\n            renderer.context.drawImage(this.canvasBuffer, 0, 0);\n        };\n    }\n}\n","module PIXI.tilemap.shaderGenerator {\n    export function fillSamplers(shader: TilemapShader, maxTextures: number) {\n        var sampleValues : Array<number> = [];\n        for (var i = 0; i < maxTextures; i++)\n        {\n            sampleValues[i] = i;\n        }\n        shader.bind();\n        shader.uniforms.uSamplers = sampleValues;\n\n        var samplerSize : Array<number> = [];\n        for (i = 0; i < maxTextures; i++) {\n            samplerSize.push(1.0 / 2048);\n            samplerSize.push(1.0 / 2048);\n        }\n        shader.uniforms.uSamplerSize = samplerSize;\n    }\n\n    export function generateFragmentSrc(maxTextures: number, fragmentSrc: string) {\n        return fragmentSrc.replace(/%count%/gi, maxTextures + \"\")\n            .replace(/%forloop%/gi, this.generateSampleSrc(maxTextures));\n    }\n\n    export function generateSampleSrc(maxTextures: number) {\n        var src = '';\n\n        src += '\\n';\n        src += '\\n';\n\n        src += 'if(vTextureId <= -1.0) {';\n        src += '\\n\\tcolor = shadowColor;';\n        src += '\\n}';\n\n        for (var i = 0; i < maxTextures; i++)\n        {\n            src += '\\nelse ';\n\n            if(i < maxTextures-1)\n            {\n                src += 'if(textureId == ' + i + '.0)';\n            }\n\n            src += '\\n{';\n            src += '\\n\\tcolor = texture2D(uSamplers['+i+'], textureCoord * uSamplerSize['+i+']);';\n            src += '\\n}';\n        }\n\n        src += '\\n';\n        src += '\\n';\n\n        return src;\n    }\n}\n"]}